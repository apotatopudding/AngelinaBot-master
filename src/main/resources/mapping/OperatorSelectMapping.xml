<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.strelitzia.dao.OperatorSelectMapper">
    <resultMap id="BaseResultMap" type="top.strelitzia.model.OperatorSelectInfo">
        <result column="group_id" property="groupId" jdbcType="INTEGER"/>
        <result column="topic_num" property="topicNum" jdbcType="INTEGER"/>
        <result column="try_num" property="tryNum" jdbcType="INTEGER"/>
        <result column="select_id_1" property="selectId1" jdbcType="INTEGER"/>
        <result column="select_id_2" property="selectId2" jdbcType="INTEGER"/>
        <result column="select_id_3" property="selectId3" jdbcType="INTEGER"/>
        <result column="select_id_4" property="selectId4" jdbcType="INTEGER"/>
        <result column="select_id_5" property="selectId5" jdbcType="INTEGER"/>
        <result column="select_id_6" property="selectId6" jdbcType="INTEGER"/>
        <result column="select_id_7" property="selectId7" jdbcType="INTEGER"/>
        <result column="select_id_8" property="selectId8" jdbcType="INTEGER"/>
        <result column="select_id_9" property="selectId9" jdbcType="INTEGER"/>
        <result column="select_id_10" property="selectId10" jdbcType="INTEGER"/>
    </resultMap>

    <!--  根据群组ID查询当前题目选中的干员名字  -->
    <select id="selectIdByGroupId" resultMap="BaseResultMap">
        SELECT
        select_id_1,
        select_id_2,
        select_id_3,
        select_id_4,
        select_id_5,
        select_id_6,
        select_id_7,
        select_id_8,
        select_id_9,
        select_id_10
        FROM
        a_operator_select
        WHERE
        group_id = #{groupId,jdbcType=INTEGER}
    </select>

    <!--  插入群号，若已存在，则更新题目序号  -->
    <update id="topicNumByGroupId">
        INSERT INTO a_operator_select (group_id)
        VALUES
        (#{groupId,jdbcType=VARCHAR}) ON CONFLICT(group_id)
        DO UPDATE SET
        topic_num = topic_num + 1
    </update>

    <!-- 更新猜测的次数  -->
    <update id="tryNumByGroupId">
        INSERT INTO a_operator_select (group_id)
        VALUES
        (#{groupId,jdbcType=VARCHAR}) ON CONFLICT(group_id)
        DO update set
        try_num = try_num + 1
    </update>

    <!--  插入群号，若已存在，则更新选中干员1 -->
    <update id="selectId1ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_1)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_1 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员2  -->
    <update id="selectId2ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_2)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_2 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员3  -->
    <update id="selectId3ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_3)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_3 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员4  -->
    <update id="selectId4ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_4)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_4 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员5  -->
    <update id="selectId5ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_5)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_5 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员6  -->
    <update id="selectId6ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_6)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_6 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员7  -->
    <update id="selectId7ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_6)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_7 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员8  -->
    <update id="selectId8ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_6)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_8 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员9  -->
    <update id="selectId9ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_6)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_9 = #{selectId,jdbcType=INTEGER}
    </update>

    <!--  插入群号，若已存在，则更新选中干员10  -->
    <update id="selectId10ByGroupId">
        INSERT INTO a_operator_select (group_id, select_id_6)
        VALUES
        (#{groupId,jdbcType=VARCHAR},1) ON CONFLICT(group_id)
        DO update set
        select_id_10 = #{selectId,jdbcType=INTEGER}
    </update>



    <!--  //根据群号查询当前题目序号以及尝试次数  -->
    <select id="OperatorNumByGroupID" resultMap="BaseResultMap">
        SELECT topic_num, try_num
        FROM
        a_operator_select
        WHERE
        group_id = #{groupId,jdbcType=INTEGER}
    </select>

    <!--  清空清空猜干员所有数据  -->
    <update id="cleanAllInfo">
        INSERT INTO a_operator_select (group_id)
        VALUES
        (#{groupId}) ON CONFLICT(group_id)
        DO update set
        select_id_1 = 0, select_id_2 = 0, select_id_3 = 0, select_id_4 = 0, select_id_5 = 0, select_id_6 = 0, select_id_7 = 0, select_id_8 = 0, select_id_9 = 0, select_id_10 = 0, topic_num = 0
    </update>

    <!--  清空清空猜干员尝试次数  -->
    <update id="cleanTryNum">
        INSERT INTO a_operator_select (group_id, try_num)
        VALUES
        (#{groupId},1) ON CONFLICT(group_id)
        DO update set
        try_num = 1
    </update>

</mapper>